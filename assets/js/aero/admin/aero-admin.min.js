"use strict";Aero.view.admin={guideid:"",type:"",render:function(e,o,a){$q(".container-close").remove(),this.type=e,Aero.tip._guide&&Aero.tip.hide(),$q(".aero-active").removeClass("aero-active"),Aero.tpl.get("sidebar-"+this.type+"-admin.html",function(a){$q(".aero-admin-wrapper").remove();var r=_q.template(a);$q("body").append(r({model:o})),$q("#aero-tab").css("left","-542px"),$q(".aero-sidebar").prepend('<div class="aero-blanket" style="display:none"></div>'),$q(".aero-blanket").fadeTo(300,.9,function(){}),"step"==e&&$q(".aero-nav-item:not(:first)").append('<a class="aero-del-nav">X</a>'),$q("#aeroEditor").trumbowyg({removeformatPasted:!0,fullscreenable:!1,resetCss:!0,autogrow:!0,height:100})}),setTimeout("$q('.aero-required:eq(0)').focus();",300),a&&$q(a).trigger("click")},renderMenu:function(e){var o=$q(".aero-strip-menu li").index(e);if($q(".aero-admin-body .open").removeClass("open"),$q(".aero-strip-menu li").removeClass("aero-menu-active"),e.addClass("aero-menu-active"),$q("#aeroSection"+o).addClass("open"),2==o&&"guide"==this.type&&Aero.view.guide.admin.renderRoles(),1==o&&"guide"==this.type&&Aero.view.guide.admin.renderPathways(),4==o&&"step"==this.type){"INPUT"!=$q($q("input[name='aero_loc']").val()).prop("tagName")&&$q('input[name="aero_mask"]').attr("disabled",!0).addClass("aero-disabled")}5!=o||"step"!=this.type||$q("#aeroBranch").data("multi-init")||$q("#aeroBranch").multiSelect({onChange:function(e){e>0?$q(".aero-branch-step").show():$q(".aero-branch-step").hide()}})},renderMenuTip:function(e,o){var a=$q('<div class="aero-menu-tip" style="top:-200px"><span></span>'+o+"</div>"),r=e.offset().top+a.outerHeight()/2+16;$q(".aero-app").append(a),a.css({top:r-$q(window).scrollTop(),left:55,opacity:0}),a.animate({opacity:1,left:"+=8"},100)},close:function(){var e=!$q(".aero-editing-step").hasClass("aero-add-step");if($q(".aero-admin-wrapper, .aero-edit-active").remove(),$q("#aero-tab").css("left","-44px"),$q(".aero-blanket").fadeTo("medium",0,function(){$q(this).remove()}),$q(".aero-editing").removeClass("aero-editing"),Aero.tip._guide&&e){var o=Aero.step.get(Aero.tip._current);Aero.tip.beforeShow(Aero.tip._current,o)}},edit:function(e,o){var a=!1,r=this,t=e.parents("li:eq(0)"),i=Aero.tip._guide?"step":"guide";r.guideid=Aero.tip._guide?Aero.tip._guide.id:e.parents("li:eq(0)").data("guideid"),t.addClass("aero-editing"),t.prepend('<span class="aero-edit-active"></span>'),Aero.guide.get(r.guideid,function(e){"step"==i&&((e=e.step[Aero.index]).id=r.guideid,e.index=Aero.index,e.isAdd=!1,o&&(e.loc=o,a=".aicon-loc")),Aero.view.admin.render(i,e,a)})},renderTools:function(e){var o=e.find(".aero-item-tools:eq(0)");if(o.length>0)o.show();else{var a=e.data("guideid")?"guide":"step",r=e.data("guideid")||Aero.tip._guide.id;Aero.tpl.get("sidebar-"+a+"-tools.html",function(o){Aero.model.guide.byId(r,function(a){var r=_q.template(o);e.prepend(r({creator:a.creator==Aero.constants.USERNAME}))})})}},setEvents:function(e){var o=this;e&&(o.type=e),$q("body").off("click.aeroCancel").on("click.aeroCancel",".aero-cancel-edit",function(){return o.close(),!1}).off("mouseenter.aerome").on("mouseenter.aerome",".aero-strip-menu a",function(){$q(".aero-menu-tip").remove(),Aero.view.admin.renderMenuTip($q(this),$q(this).data("title"))}).off("mouseleave.aeroml").on("mouseleave.aeroml",".aero-strip-menu a",function(){$q(".aero-menu-tip").remove()}).off("click.aeroTools").on("mouseenter.aeroTools",".aero-"+o.type+"s ul li",function(){return Aero.view.admin.renderTools($q(this)),!1}).off("click.aeroTools").on("mouseleave.aeroTools",".aero-"+o.type+"s ul li",function(){$q(".aero-item-tools").hide()}).off("change.aerob").on("change.aerob","select[name='aero_branch']",function(){$q('select[name="aero_return"]').parents("div:eq(0)").hide(),""!=$q(this).val()&&$q('select[name="aero_return"]').parents("div:eq(0)").show()})}};