"use strict";Aero.model.pathway={url:"api/pathway"},Aero.view.pathway={render:function(e,t){$q(".aero-here").remove(),$q(".ae-here").removeClass("ae-here");try{var a=e[t].title,o=e[t].id;return 0==t?Aero.guide.getAll(function(e){Aero.view.guide.render(e)}):t==e.length-1?Aero.onpage.getGuides(function(e){e[0].path="On This Page",Aero.view.guide.render(e)}):Aero.pathway.getGuides(o,function(e){e.length>0&&(e[0].path=a,e[0].pathid=o,Aero.view.guide.render(e))}),aeroStorage.setItem("aero:pathway",t),aeroStorage.setItem("aero:pathway:name",a),!0}catch(e){return!1}},setEvents:function(){var e=this;$q("body").off("click.aeropath").on("click.aeropath",'.aero-carousel a:not(".aero-share")',function(){var t=$q(this).hasClass("aero-left");return Aero.pathway.get(function(a){var o=aeroStorage.getItem("aero:pathway"),r=a.length-1,n=o||0;t?n--:n++,n<0&&(n=0),n>r&&(n=r),e.render(a,n)}),!1})}},Aero.pathway={init:function(){Aero.view.pathway.setEvents()},get:function(e,t){if(Aero.constants.PATHWAYS)e(Aero.constants.PATHWAYS);else{var a={};a.dropEmpty=!0,a.count=!0,a.select=["title"],t&&(a={id:t}),Aero.send(Aero.model.pathway.url,a,function(t){t||(t=[]),Aero.constants.PATHWAYS=[];var a=[{title:AeroStep.lang.allguides}];$q.isArray(t)&&(Aero.constants.PATHWAYS=a.concat(t),Aero.constants.PATHWAYS.push({title:"On This Page"})),e&&e(Aero.constants.PATHWAYS)},"GET")}},getGuides:function(e,t){Aero.constants.pathway||(Aero.constants.pathway={}),!Aero.tip._guide&&Aero.constants.pathway&&Aero.constants.pathway[e]?t(Aero.constants.pathway[e]):Aero.send("api/pathwaymap/by_pathway",{active:!0,pathwayid:e},function(a){Aero.constants.pathway[e]=a,t&&t(a)},"GET")}},Aero.onpage={getGuides:function(e){var t=this,a=[];Aero.guide.getAll(function(o){var r=AeroStep.getSubURL(window.location.pathname);for(var n in o){var i=o[n].step[0];i&&(i.position&&"orphan"==i.position&&(i=o[n].step[1]),("body"!=i.loc&&"all"==i.noUrl||i.url==r||!i.url&&"/"==r)&&a.push(o[n]))}e&&e(a),t.render(a)})},render:function(e){$q(".aero-here").remove(),$q(".ae-here").removeClass("ae-here");var t=0;for(var a in e)if(e[a]){var o,r,n,i;if((o=e[a].step[0]).position&&"orphan"==o.position&&(o=e[a].step[1]),(n=(r=$q(o.loc)).offset())&&r&&!r.hasClass("ae-here")){r.addClass("ae-here").data("ae-id",t),i=$q('<a id="ae-id-'+t+'" class="aero-here">X</a>');try{i.css({top:n.top-20,left:n.left-37}).data("guideids",e[a].id)}catch(e){Aero.log("Failed On Page:"+e,"error")}$q("body").append(i),t++}this.setEvents()}},setEvents:function(){$q(".aero-here").off("click.aeop").on("click.aeop",function(){Aero.tip.start($q(this).data("guideids")),$q(".aero-here").remove()})}};