"use strict";var Aero={constants:{PATH:AeroStep.baseUrl,USERNAME:AeroStep.getUsername()},model:{},view:{},host:AeroStep.host,send:function(e,o,t,n){n||(n="GET"),o.host||(o.host=this.host),o.locale||(o.locale=AeroStep.locale),"POST"!=n&&"PUT"!=n||(o=JSON.stringify(o));var i={async:!1,type:n,data:o,dataType:"json",contentType:"application/json",url:e=this.constants.PATH+e,success:function(e){t&&t(e)},error:function(o,t){var n=e+" says: "+JSON.stringify(o)+" "+JSON.stringify(t);Aero.log(JSON.stringify(n))}};"GET"==n&&(i.dataType="jsonp"),$q.ajax(i)},log:function(e,o){if(AeroStep.debug)if(o)switch(o){case"error":console.log("%c"+e,"background: #ea8181; color: #333");break;case"warn":console.log("%c"+e,"background: #eac481; color: #333");break;case"success":console.log("%c"+e,"background: #8eea81; color: #333");break;case"info":console.log("%c"+e,"background: #81d7ea; color: #333")}else console.log(e)}};Aero.utils={getUrlParam:function(e){var o,t,n=decodeURIComponent(window.location.search.substring(1)).split("&");for(t=0;t<n.length;t++)if((o=n[t].split("="))[0]===e)return void 0===o[1]||o[1]}},Aero.confirm=function(e){var o,t={ok:AeroStep.lang.ok,cancel:AeroStep.lang.cancel,title:"",msg:"",confirm:!1,onClose:function(){},onConfirm:function(){},onCancel:function(){},onValidate:function(){return!0}};$q.extend(t,e);function n(){(o=$q(".aero-modal")).animate({top:-t.height},300,function(){$q(".aero-backdrop, .aero-modal").fadeTo(200,0).remove()})}function i(){t.onValidate()&&(t.onConfirm(),n())}Aero.tpl.get("modal.html",function(e){var r=_q.template(e);$q("body").append(r({msg:t})),o=$q(".aero-modal").hide(),t.height=o.outerHeight(),o.css({top:$q(window).height()/2-t.height/2,left:$q(window).width()/2-o.outerWidth()/2}),$q(".aero-backdrop").fadeTo(200,.5,function(){o.show(),$q(".aero-modal-body").find("input:eq(0)").focus()}),t.onConfirm,$q("body").off("keyup.smw").on("keyup.smw",function(e){var o=e.keyCode||e.which;"27"==o&&(t.onCancel(),n())}),$q("body").off("click.amwc").on("click.amwc",".aero-modal-close",function(e){t.onClose(),n()}),$q("body").off("click.confok").on("click.confok",".aero-btn-ok",function(){i()}),$q("body").off("click.confc").on("click.confc",".aero-btn-no",function(){t.onCancel(),n()}),$q(".aero-modal").off("keypress.confk").on("keypress.confk",function(e){var o=e.keyCode||e.which;if("13"==o)return i(),!1})})},$q.fn.scrollParent=function(){var e=/(auto|scroll)/,o=this.css("position"),t="absolute"===o,n=this.parents().filter(function(){var o=$q(this);return(!t||"static"!==o.css("position"))&&e.test(o.css("overflow")+o.css("overflow-y")+o.css("overflow-x"))}).eq(0);return"fixed"!==o&&n.length?n:$q(this[0].ownerDocument||document)},Aero.pos={isFixed:function(e){var o=$q(e),t=!1;return o.add(o.parents()).each(function(){if("fixed"===$q(this).css("position"))return t=!0,!1}),t},isScrollable:function(e){var o=e.scrollParent(),t=o.prop("tagName");return!(!t||"HTML"==t||"BODY"==t||"DOCUMENT"==t)&&o}},Aero.tpl={templates:{},get:function(e,o){var t=this,n={name:e,guest:Aero.constants.USERNAME};t.templates[e]?o&&o(t.templates[e]):Aero.send("api/template",n,function(n){var i=JSON.parse(n);Aero.tpl.templates[e]=i.tpl,o&&o(t.templates[e])})}},$q.fn.aeroSerialize=function(){var e={},o=this.serializeArray();return $q.each(o,function(){var o=this.name.replace("aero_","");void 0!==e[o]?(e[o].push||(e[o]=[e[this.name]]),e[o].push(this.value||"")):e[o]=this.value||""}),e},function(e){var o={onChange:function(){}},t={init:function(n){var i,r,a,s;i=$q(this),a=$q(this).attr("id"),s=0,o.onChange=n.onChange,i.hide().data("multi-init",!0),r=$q('<div id="aeSelect'+a+'" class="aero-multi-select"><a class="aero-multi-drop"></a><ul style="display:none"></ul></div>'),i.after(r),i.find("option").each(function(){if(""!=e(this).val()&&e(this).val()!=Aero.tip._guide.id){var o=e(this).is(":selected")?'checked="true"':"";r.find("ul").append('<li><label><input type="checkbox" '+o+'value="'+this.value+'" />'+this.text+"</label></li>"),""!=o&&s++}});var l=s>0?s+" Selected":"Select Guides";e("#aeSelect"+a).find(".aero-multi-drop").html(l),t.setEvents(a)},setEvents:function(t){var n="#aeSelect"+t;e("body").on("click",function(){e(n).find("ul").hide()}),e(n).find("a.aero-multi-drop").on("click",function(o){e(this).parent().find("ul").is(":visible")?e(this).parent().find("ul").hide():e(this).parent().find("ul").show(),o.stopPropagation()}).attr("unselectable","on").css("user-select","none").on("selectstart",!1),e(n).find(".aero-multi-select li, .aero-multi-select label").on("click",function(e){e.stopPropagation()}),e(n).find("input[type=checkbox]").on("change",function(i){e("#"+t+" option[value="+e(this).val()+"]").attr("selected",e(this).is(":checked"));var r=e(n).find("input:checked").length,a=r>0?r+" Selected":"Select Guides";e(n).find(".aero-multi-drop").html(a),o.onChange(r),i.stopPropagation()})}};e.fn.multiSelect=function(o){return t[o]?t[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void e.error("Method "+o+" does not exist on jQuery.tooltip"):t.init.apply(this,arguments)}}($q),$q.fn.isFormValid=function(){var e=[];return $q(".aero-require-error").removeClass("aero-require-error"),$q(".aero-error-box").remove(),$q(this).find(".aero-required").each(function(){$q(this).removeClass("aero-require-error"),""==$q(this).val()&&(0==e.length&&e.push(AeroStep.lang.requirede),$q(this).addClass("aero-require-error"))}),!(e.length>0)||($q(".aero-modal form:eq(0)").length>0&&$q(".aero-modal form:eq(0)").prepend('<div class="aero-error-box"><ul><li>'+e.join("</li><li>")+"</li></ul></div>"),!1)},$q.fn.visible=function(e,o){var t=o||$q(window),n=(this.length>1?this.eq(0):this).get(0),i=t.width(),r=t.height();if("function"==typeof n.getBoundingClientRect){var a=n.getBoundingClientRect(),s=a.top>=0&&a.top<r,l=a.bottom>0&&a.bottom<=r,c=a.left>=0&&a.left<i,u=a.right>0&&a.right<=i;return(e?s||l:s&&l)&&(e?c||u:c&&u)}},function(e){var o,t=e.fn.on;e.fn.on=function(){var e=Array.apply(null,arguments),n=e[e.length-1];if(isNaN(n)||1===n&&e.pop())return t.apply(this,e);var i=e.pop(),r=e.pop();return e.push(function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){r.apply(e,t)},i)}),t.apply(this,e)}}(this.$q),Object.keys||(Object.keys=function(e){var o=[];for(var t in e)e.hasOwnProperty(t)&&o.push(t);return o}),"undefined"!=typeof aerofire&&aerofire.init(),"undefined"!=typeof Prototype&&parseFloat(Prototype.Version.substr(0,3))<1.7&&void 0!==Array.prototype.toJSON&&window.Prototype&&(delete Object.prototype.toJSON,delete Array.prototype.toJSON,delete Hash.prototype.toJSON,delete String.prototype.toJSON);