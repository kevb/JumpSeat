"use strict";var Aero={constants:{PATH:AeroStep.baseUrl,USERNAME:AeroStep.getUsername()},model:{},view:{},host:AeroStep.host,send:function(e,o,t,n){n||(n="GET"),o.host||(o.host=this.host),o.locale||(o.locale=AeroStep.locale),"POST"!=n&&"PUT"!=n||(o=JSON.stringify(o));var i={async:!1,type:n,data:o,dataType:"json",contentType:"application/json",url:e=this.constants.PATH+e,success:function(e){t&&t(e)},error:function(o,t){var n=e+" says: "+JSON.stringify(o)+" "+JSON.stringify(t);Aero.log(JSON.stringify(n))}};"GET"==n&&(i.dataType="jsonp"),$q.ajax(i)},log:function(e,o){if(AeroStep.debug)if(o)switch(o){case"error":console.log("%c"+e,"background: #ea8181; color: #333");break;case"warn":console.log("%c"+e,"background: #eac481; color: #333");break;case"success":console.log("%c"+e,"background: #8eea81; color: #333");break;case"info":console.log("%c"+e,"background: #81d7ea; color: #333")}else console.log(e)}};Aero.utils={getUrlParam:function(e){var o,t,n=decodeURIComponent(window.location.search.substring(1)).split("&");for(t=0;t<n.length;t++)if((o=n[t].split("="))[0]===e)return void 0===o[1]||o[1]}},Aero.confirm=function(e){var o,t={ok:AeroStep.lang.ok,cancel:AeroStep.lang.cancel,title:"",msg:"",confirm:!1,onClose:function(){},onConfirm:function(){},onCancel:function(){},onValidate:function(){return!0}};$q.extend(t,e);function n(){(o=$q(".aero-modal")).animate({top:-t.height},300,function(){$q(".aero-backdrop, .aero-modal").fadeTo(200,0).remove()})}function i(){t.onValidate()&&(t.onConfirm(),n())}Aero.tpl.get("modal.html",function(e){var r=_q.template(e);$q("body").append(r({msg:t})),o=$q(".aero-modal").hide(),t.height=o.outerHeight(),o.css({top:$q(window).height()/2-t.height/2,left:$q(window).width()/2-o.outerWidth()/2}),$q(".aero-backdrop").fadeTo(200,.5,function(){o.show(),$q(".aero-modal-body").find("input:eq(0)").focus()}),t.onConfirm,$q("body").off("keyup.smw").on("keyup.smw",function(e){var o=e.keyCode||e.which;"27"==o&&(t.onCancel(),n())}),$q("body").off("click.amwc").on("click.amwc",".aero-modal-close",function(e){t.onClose(),n()}),$q("body").off("click.confok").on("click.confok",".aero-btn-ok",function(){i()}),$q("body").off("click.confc").on("click.confc",".aero-btn-no",function(){t.onCancel(),n()}),$q(".aero-modal").off("keypress.confk").on("keypress.confk",function(e){var o=e.keyCode||e.which;if("13"==o)return i(),!1})})},$q.fn.scrollParent=function(){var e=/(auto|scroll)/,o=this.css("position"),t="absolute"===o,n=this.parents().filter(function(){var o=$q(this);return(!t||"static"!==o.css("position"))&&e.test(o.css("overflow")+o.css("overflow-y")+o.css("overflow-x"))}).eq(0);return"fixed"!==o&&n.length?n:$q(this[0].ownerDocument||document)},Aero.pos={isFixed:function(e){var o=$q(e),t=!1;return o.add(o.parents()).each(function(){if("fixed"===$q(this).css("position"))return t=!0,!1}),t},isScrollable:function(e){var o=e.scrollParent(),t=o.prop("tagName");return!(!t||"HTML"==t||"BODY"==t||"DOCUMENT"==t)&&o}},Aero.tpl={templates:{},get:function(e,o){var t=this,n={name:e,guest:Aero.constants.USERNAME};t.templates[e]?o&&o(t.templates[e]):Aero.send("api/template",n,function(n){var i=JSON.parse(n);Aero.tpl.templates[e]=i.tpl,o&&o(t.templates[e])})}},$q.fn.aeroSerialize=function(){var e={},o=this.serializeArray();return $q.each(o,function(){var o=this.name.replace("aero_","");void 0!==e[o]?(e[o].push||(e[o]=[e[this.name]]),e[o].push(this.value||"")):e[o]=this.value||""}),e},function(e){var o={onChange:function(){}},t={init:function(n){var i,r,a,s;i=$q(this),a=$q(this).attr("id"),s=0,o.onChange=n.onChange,i.hide().data("multi-init",!0),r=$q('<div id="aeSelect'+a+'" class="aero-multi-select"><a class="aero-multi-drop"></a><ul style="display:none"></ul></div>'),i.after(r),i.find("option").each(function(){if(""!=e(this).val()&&e(this).val()!=Aero.tip._guide.id){var o=e(this).is(":selected")?'checked="true"':"";r.find("ul").append('<li><label><input type="checkbox" '+o+'value="'+this.value+'" />'+this.text+"</label></li>"),""!=o&&s++}});var l=s>0?s+" Selected":"Select Guides";e("#aeSelect"+a).find(".aero-multi-drop").html(l),t.setEvents(a)},setEvents:function(t){var n="#aeSelect"+t;e("body").on("click",function(){e(n).find("ul").hide()}),e(n).find("a.aero-multi-drop").on("click",function(o){e(this).parent().find("ul").is(":visible")?e(this).parent().find("ul").hide():e(this).parent().find("ul").show(),o.stopPropagation()}).attr("unselectable","on").css("user-select","none").on("selectstart",!1),e(n).find(".aero-multi-select li, .aero-multi-select label").on("click",function(e){e.stopPropagation()}),e(n).find("input[type=checkbox]").on("change",function(i){e("#"+t+" option[value="+e(this).val()+"]").attr("selected",e(this).is(":checked"));var r=e(n).find("input:checked").length,a=r>0?r+" Selected":"Select Guides";e(n).find(".aero-multi-drop").html(a),o.onChange(r),i.stopPropagation()})}};e.fn.multiSelect=function(o){return t[o]?t[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void e.error("Method "+o+" does not exist on jQuery.tooltip"):t.init.apply(this,arguments)}}($q),$q.fn.isFormValid=function(){var e=[];return $q(".aero-require-error").removeClass("aero-require-error"),$q(".aero-error-box").remove(),$q(this).find(".aero-required").each(function(){$q(this).removeClass("aero-require-error"),""==$q(this).val()&&(0==e.length&&e.push(AeroStep.lang.requirede),$q(this).addClass("aero-require-error"))}),!(e.length>0)||($q(".aero-modal form:eq(0)").length>0&&$q(".aero-modal form:eq(0)").prepend('<div class="aero-error-box"><ul><li>'+e.join("</li><li>")+"</li></ul></div>"),!1)},$q.fn.visible=function(e,o){var t=o||$q(window),n=(this.length>1?this.eq(0):this).get(0),i=t.width(),r=t.height();if("function"==typeof n.getBoundingClientRect){var a=n.getBoundingClientRect(),s=a.top>=0&&a.top<r,l=a.bottom>0&&a.bottom<=r,c=a.left>=0&&a.left<i,u=a.right>0&&a.right<=i;return(e?s||l:s&&l)&&(e?c||u:c&&u)}},function(e){var o,t=e.fn.on;e.fn.on=function(){var e=Array.apply(null,arguments),n=e[e.length-1];if(isNaN(n)||1===n&&e.pop())return t.apply(this,e);var i=e.pop(),r=e.pop();return e.push(function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){r.apply(e,t)},i)}),t.apply(this,e)}}(this.$q),Object.keys||(Object.keys=function(e){var o=[];for(var t in e)e.hasOwnProperty(t)&&o.push(t);return o}),"undefined"!=typeof aerofire&&aerofire.init(),"undefined"!=typeof Prototype&&parseFloat(Prototype.Version.substr(0,3))<1.7&&void 0!==Array.prototype.toJSON&&window.Prototype&&(delete Object.prototype.toJSON,delete Array.prototype.toJSON,delete Hash.prototype.toJSON,delete String.prototype.toJSON);
"use strict";Aero.model.audit={key:"aero:session:audit",defaults:function(){return{user:Aero.constants.USERNAME,guideid:Aero.tip._guide.id,pathwayid:Aero.pathway.pathwayid,progress:1,perc:Math.round(1/Aero.tip._guide.step.length*100),timeStart:"",timeStamp:this.getTime(),timeTotal:""}},get:function(){return JSON.parse(aeroStorage.getItem(this.key))},update:function(e){if(!AeroStep.admin&&Aero.tip._guide){var t=JSON.parse(aeroStorage.getItem(this.key));t&&""!=t.id&&""==e.id&&(e.id=t.id),e.timeStamp=this.getTime(),aeroStorage.setItem(this.key,JSON.stringify(e))}},getTime:function(){var e=new Date;return e.getFullYear()+"-"+this.padZero(e.getMonth()+1)+"-"+this.padZero(e.getDate())+" "+this.padZero(e.getHours())+":"+this.padZero(e.getMinutes())+":"+this.padZero(e.getSeconds())},padZero:function(e){return("0"+e).slice(-2)}},Aero.view.audit={timeStart:0,timeTotal:0,setEvents:function(){this.startTimer(),$q(window).on("beforeunload",function(){Aero.audit.save()}),$q(window).on("focus.aerof",function(){Aero.view.audit.startTimer()}).on("blur.aerob",function(){Aero.view.audit.stopTimer()})},removeEvents:function(){$q(window).off("blur.aerob focus.aerof")},startTimer:function(){this.timeStart=(new Date).getTime()},stopTimer:function(){var e=(new Date).getTime();this.timeTotal=e-this.timeStart+this.timeTotal}},Aero.audit={enabled:!0,url:"api/audit",id:"",furthestStep:0,init:function(e){var t=!0;Aero.audit.furthestStep=0,Aero.view.audit.timeTotal=0,!AeroStep.admin&&Aero.constants.USERNAME&&void 0!==Aero.tip._guide&&Aero.tip._guide&&!aeroStorage.getItem("aero:session:audit")||(t=!1),aeroStorage.getItem("aero:session:branch:audit")&&(t=!0,aeroStorage.removeItem("aero:session:branch:audit")),Aero.view.audit.setEvents(),t?this.create(e):e()},create:function(e){if(!AeroStep.admin){var t=this,i=Aero.model.audit.defaults();i.timeStart=i.timeStamp,i.timeTotal=Aero.view.audit.timeTotal,Aero.send(this.url+"/create",{data:JSON.stringify(i)},function(o){t.id=o,i.id=o,Aero.model.audit.update(i),e&&e()},"GET")}},update:function(){if(!AeroStep.admin){var e=Aero.model.audit.get(),t=Aero.tip._current;t<this.furthestStep||(this.furthestStep=t,e.progress=t+1,e.perc=Math.round((t+1)/Aero.tip._guide.step.length*100),e.id=this.id,e.timeTotal=Aero.view.audit.timeTotal,Aero.model.audit.update(e))}},save:function(e){if(!AeroStep.admin&&Aero.tip._guide){var t=Aero.model.audit.get();t&&(Aero.view.audit.stopTimer(),t.timeTotal=Aero.view.audit.timeTotal,Aero.view.audit.removeEvents(),Aero.send(this.url+"/update",{data:JSON.stringify(t)},function(e){Aero.model.audit.update(t)},"GET")),e&&e()}}};
"use strict";Aero.model.pathway={url:"api/pathway"},Aero.view.pathway={render:function(e,t){$q(".aero-here").remove(),$q(".ae-here").removeClass("ae-here");try{var a=e[t].title,o=e[t].id;return 0==t?Aero.guide.getAll(function(e){Aero.view.guide.render(e)}):t==e.length-1?Aero.onpage.getGuides(function(e){e[0].path="On This Page",Aero.view.guide.render(e)}):Aero.pathway.getGuides(o,function(e){e.length>0&&(e[0].path=a,e[0].pathid=o,Aero.view.guide.render(e))}),aeroStorage.setItem("aero:pathway",t),aeroStorage.setItem("aero:pathway:name",a),!0}catch(e){return!1}},setEvents:function(){var e=this;$q("body").off("click.aeropath").on("click.aeropath",'.aero-carousel a:not(".aero-share")',function(){var t=$q(this).hasClass("aero-left");return Aero.pathway.get(function(a){var o=aeroStorage.getItem("aero:pathway"),r=a.length-1,n=o||0;t?n--:n++,n<0&&(n=0),n>r&&(n=r),e.render(a,n)}),!1})}},Aero.pathway={init:function(){Aero.view.pathway.setEvents()},get:function(e,t){if(Aero.constants.PATHWAYS)e(Aero.constants.PATHWAYS);else{var a={};a.dropEmpty=!0,a.count=!0,a.select=["title"],t&&(a={id:t}),Aero.send(Aero.model.pathway.url,a,function(t){t||(t=[]),Aero.constants.PATHWAYS=[];var a=[{title:AeroStep.lang.allguides}];$q.isArray(t)&&(Aero.constants.PATHWAYS=a.concat(t),Aero.constants.PATHWAYS.push({title:"On This Page"})),e&&e(Aero.constants.PATHWAYS)},"GET")}},getGuides:function(e,t){Aero.constants.pathway||(Aero.constants.pathway={}),!Aero.tip._guide&&Aero.constants.pathway&&Aero.constants.pathway[e]?t(Aero.constants.pathway[e]):Aero.send("api/pathwaymap/by_pathway",{active:!0,pathwayid:e},function(a){Aero.constants.pathway[e]=a,t&&t(a)},"GET")}},Aero.onpage={getGuides:function(e){var t=this,a=[];Aero.guide.getAll(function(o){var r=AeroStep.getSubURL(window.location.pathname);for(var n in o){var i=o[n].step[0];i&&(i.position&&"orphan"==i.position&&(i=o[n].step[1]),("body"!=i.loc&&"all"==i.noUrl||i.url==r||!i.url&&"/"==r)&&a.push(o[n]))}e&&e(a),t.render(a)})},render:function(e){$q(".aero-here").remove(),$q(".ae-here").removeClass("ae-here");var t=0;for(var a in e)if(e[a]){var o,r,n,i;if((o=e[a].step[0]).position&&"orphan"==o.position&&(o=e[a].step[1]),(n=(r=$q(o.loc)).offset())&&r&&!r.hasClass("ae-here")){r.addClass("ae-here").data("ae-id",t),i=$q('<a id="ae-id-'+t+'" class="aero-here">X</a>');try{i.css({top:n.top-20,left:n.left-37}).data("guideids",e[a].id)}catch(e){Aero.log("Failed On Page:"+e,"error")}$q("body").append(i),t++}this.setEvents()}},setEvents:function(){$q(".aero-here").off("click.aeop").on("click.aeop",function(){Aero.tip.start($q(this).data("guideids")),$q(".aero-here").remove()})}};
"use strict";Aero.view.quiz={tpl:function(i){return'<li class="clearfix"><label><input data-ans="'+i.correct+'" type="checkbox" value="1"/>'+i.title+"</label></li>"},render:function(i,e){var a='<div class="aero-quiz aero-quiz-'+(e=e||"")+'"><ul class="clearfix">';for(var r in i)$q.isFunction(i[r])||(a+=this.tpl(i[r]));return a+="</ul></div>"},renderNotification:function(i,e,a){var r="";switch(a){case"err":r='<i class="fa fa fa-warning"></i>Incorrect Answer!',e&&""!=e&&(r+="<div>"+e+"</div>");break;case"warn":r='<i class="fa fa fa-warning"></i>Please select an answer!';break;case"success":r='<i class="fa fa-check-square-o"></i> Correct!'}$q(".aero-msg").remove(),i.find(".aero-tip-body").prepend('<div class="aero-msg aero-'+a+'">'+r+"</div>")},validate:function(i){var e=!0,a=0;return $q("#"+i.id).find("input").each(function(){$q(this).is(":checked")&&(a+=1),$q(this).data("ans")!=$q(this).is(":checked")&&(e=!1)}),0==a?this.renderNotification($q("#"+i.id),null,"warn"):e?this.renderNotification($q("#"+i.id),null,"success"):this.renderNotification($q("#"+i.id),i.errmsg,"err"),e}};
"use strict";Aero.view.media={tpl:function(e,r){var t=e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/),u=r?.6*r+"px":"100%";return t&&11==t[2].length?'<iframe width="100%" height="'+u+'" src="//www.youtube.com/embed/'+t[2]+'" frameborder="0" allowfullscreen></iframe>':"error"},render:function(e){return e.youtube?this.tpl(e.youtube,e.size):e.embed?e.embed:void 0}};
"use strict";!function(e){var t=(e.browser.msie?"paste":"input")+".mask",r=void 0!=window.orientation;e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn"},e.fn.extend({caret:function(e,t){if(0!=this.length){if("number"==typeof e)return t="number"==typeof t?t:e,this.each(function(){if(this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var r=this.createTextRange();r.collapse(!0),r.moveEnd("character",t),r.moveStart("character",e),r.select()}});if(this[0].setSelectionRange)e=this[0].selectionStart,t=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var r=document.selection.createRange();e=0-r.duplicate().moveStart("character",-1e5),t=e+r.text.length}return{begin:e,end:t}}},unmask:function(){return this.trigger("unmask")},mask:function(o,a){if(!o&&this.length>0){return e(this[0]).data(e.mask.dataName)()}a=e.extend({placeholder:"_",completed:null},a);var n=e.mask.definitions,i=[],s=o.length,c=null,u=o.length;return e.each(o.split(""),function(e,t){"?"==t?(u--,s=e):n[t]?(i.push(new RegExp(n[t])),null==c&&(c=i.length-1)):i.push(null)}),this.trigger("unmask").each(function(){function d(e){for(var t=g.val(),r=-1,o=0,n=0;o<u;o++)if(i[o]){for(h[o]=a.placeholder;n++<t.length;){var d=t.charAt(n-1);if(i[o].test(d)){h[o]=d,r=o;break}}if(n>t.length)break}else h[o]==t.charAt(n)&&o!=s&&(n++,r=o);return!e&&r+1<s?(g.val(""),p(0,u)):(e||r+1>=s)&&(l(),e||g.val(g.val().substring(0,r+1))),s?o:c}function l(){return g.val(h.join("")).val()}function p(e,t){for(var r=e;r<t&&r<u;r++)i[r]&&(h[r]=a.placeholder)}function f(e,t){if(!(e<0)){for(var r=e,o=m(t);r<u;r++)if(i[r]){if(!(o<u&&i[r].test(h[o])))break;h[r]=h[o],h[o]=a.placeholder,o=m(o)}l(),g.caret(Math.max(c,e))}}function m(e){for(;++e<=u&&!i[e];);return e}var g=e(this),h=e.map(o.split(""),function(e,t){if("?"!=e)return n[e]?a.placeholder:e}),v=g.val();g.data(e.mask.dataName,function(){return e.map(h,function(e,t){return i[t]&&e!=a.placeholder?e:null}).join("")}),g.attr("readonly")||g.one("unmask",function(){g.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){v=g.val();var t=d();l();var r=function(){t==o.length?g.caret(0,t):g.caret(t)};(e.browser.msie?r:function(){setTimeout(r,0)})()}).bind("blur.mask",function(){d(),g.val()!=v&&g.change()}).bind("keydown.mask",function(e){var t=e.which;if(8==t||46==t||r&&127==t){var o=g.caret(),a=o.begin,n=o.end;return n-a==0&&(a=46!=t?function(e){for(;--e>=0&&!i[e];);return e}(a):n=m(a-1),n=46==t?m(n):n),p(a,n),f(a,n-1),!1}if(27==t)return g.val(v),g.caret(0,d()),!1}).bind("keypress.mask",function(e){var t=e.which,r=g.caret();if(e.ctrlKey||e.altKey||e.metaKey||t<32)return!0;if(t){r.end-r.begin!=0&&(p(r.begin,r.end),f(r.begin,r.end-1));var o=m(r.begin-1);if(o<u){var n=String.fromCharCode(t);if(i[o].test(n)){(function(e){for(var t=e,r=a.placeholder;t<u;t++)if(i[t]){var o=m(t),n=h[t];if(h[t]=r,!(o<u&&i[o].test(n)))break;r=n}})(o),h[o]=n,l();var s=m(o);g.caret(s),a.completed&&s>=u&&a.completed.call(g)}}return!1}}).bind(t,function(){setTimeout(function(){g.caret(d(!0))},0)}),d()})}})}($q),Aero.model.step={url:"api/steps",defaults:function(e){var t=e+1;return Aero.tip._guide.step&&(t=e===Aero.tip._guide.step.length-1?-1:e+1),{loc:"",tries:3,position:"bottom",id:"astep-"+e,next:t,prev:e-1}},update:function(e,t){aeroStorage.getItem("aero:session:index",function(r){var o=JSON.parse(aeroStorage.getItem("aero:guides"));o[r=parseInt(r)]=e,aeroStorage.setItem("aero:session:end",0),aeroStorage.setItem("aero:guides",JSON.stringify(o),function(){}),aeroStorage.setItem("aero:session",JSON.stringify(o[r]),function(){Aero.tip.setGuide(e.id,function(){Aero.tip._current==Aero.tip._guide.step.length&&Aero.tip._current--,Aero.tip._current||(Aero.tip._current=0),t||Aero.tip.jumpTo(Aero.tip._current)})},!0)},!0)},validate:function(){var e=$q("form").isFormValid();if(""==$q("#aeroEditor").trumbowyg("html").replace(/<br>/g,"")&&(e=!1,$q(".trumbowyg-editor").addClass("aero-require-error")),!e){$q("#aeroSection0 p:first").after('<div class="aero-error-box">'+AeroStep.lang.requirede+"</div>");var t=$q(".aero-require-error:eq(0)").parents(".aero-tab-content:eq(0)");t&&t.parent().find('a[href="#'+t.attr("id")+'"]').click()}return e}},Aero.view.step={render:function(e){var t=this;Aero.tpl.get("sidebar-steps.html",function(r){aeroStorage.getItem("aero:sidebar:open",function(o){aeroStorage.getItem("aero:session:tab",function(a){$q("#aeroStepbar").remove();var n=_q.template(r);$q("body").append(n({sidebar:o,g:e})),$q("#aeroGuidebar").remove(),a>$q("#aeroStepbar").outerHeight()&&(a=$q("#aeroStepbar").outerHeight()-100),a<0&&(a=0),$q("#aero-tab").css("top",a+"px"),t.setEvents(),Aero.view.sidebar.setScrollable()},!0)},!0)}),Aero.view.sidebar.setEvents()},renderShare:function(e){$q("body").append('<div class="aero-share-tip"><span></span><input type="text" value="'+e+'" /></div>'),$q(".aero-share-tip input").select()},setState:function(e,t){if(e||(e=Aero.tip._current),t)$q(".aero-steps li:eq("+e+")").attr("class","clearfix aero-"+t);else{var r=$q(".aero-steps li:eq("+e+")");r.addClass("aero-active"),r.removeClass("aero-forward aero-missing"),aeroStorage.removeItem("aero:session:forward",function(){},!0)}var o=$q("div.aero-steps"),a=$q("li.aero-active"),n=$q("div.aero-add-step"),i=0;a.length>0&&(n.length>0&&(i+=n.outerHeight()),o.animate({scrollTop:o.scrollTop()+a.position().top-o.height()/2+a.height()/2-i-$q(".aero-guide-title").outerHeight()}))},setEvents:function(){var e=this;AeroStep.admin&&$q("body").off("click.sa").on("click.sa",".aero-steps li > a",function(){Aero.tip.jumpTo($q(".aero-steps li").index($q(this).parent()))}),$q("body").off("click.aplay").on("click.aplay","a.aero-play-icon",function(){Aero.view.step.setState(parseInt(aeroStorage.getItem("aero:session:pause")),"non"),aeroStorage.removeItem("aero:session:pause"),Aero.tip.jumpTo(Aero.tip._current),$q(".aero-play").fadeOut(1e3,function(){$q(this).remove()})}),$q("body").off("click.sas").on("click.sas","a.aero-stop",function(){Aero.tip.stop()}),$q("body").off("click.ashare").on("click.ashare","a.aero-share",function(){return e.renderShare(Aero.host+$q(this).data("link")),!1}),$q(document).click(function(e){$q(e.target).hasClass("aero-share-tip")||$q(e.target).parent().hasClass("aero-share-tip")||$q(".aero-share-tip").remove()}),$q("#aero-tab").draggable({axis:"y",distance:10,containment:"body",stop:function(e,t){aeroStorage.setItem("aero:session:tab",t.offset.top,function(){},!0)}}),AeroStep.admin&&setTimeout("if(Aero.view.step.admin) Aero.view.step.admin.renderSortable();",100)}},Aero.step={get:function(e){try{var t=new Aero.model.step.defaults(e);return $q.extend({},t,Aero.tip._guide.step[e])}catch(e){AeroStep.session.destroy(),location.reload(!0)}},add:function(e,t,r){e.id=Aero.tip._guide.id,e.insertAt=Aero.tip._current?Aero.tip._current:0,Aero.send(Aero.model.step.url,e,function(e){0!=Aero.tip._guide.step.length&&Aero.tip._current++,Aero.model.step.update(e,r),t&&t(e)},"POST")},update:function(e,t,r){t.id=Aero.tip._guide.id,t.index=e,Aero.send(Aero.model.step.url,t,function(e){Aero.model.step.update(e),r&&r(e)},"PUT")},moveIndex:function(e,t){Aero.send(Aero.model.step.url+"/move",{id:Aero.tip._guide.id,from:e,to:t},function(e){Aero.model.step.update(e)},"PUT")},destroy:function(e,t){Aero.send(Aero.model.step.url,{id:Aero.tip._guide.id,index:e},function(e){Aero.model.step.update(e),t&&t(e)},"DELETE")}};
"use strict";Aero.tip={tries:0,options:{labels:{end:AeroStep.lang.finished,next:AeroStep.lang.next,prev:AeroStep.lang.prev},template:function(e){var t="",o="",r="",i="",s=e.position?e.position:"top",a=parseInt(Aero.tip._current)+1,n=Aero.tip._guide?Aero.tip._guide.step.length:0;t=isNaN(e.size)?e.size&&""!=e.size?" aero-tip-"+e.size:"":"' style='width:"+e.size+"px'";var p=["OVERVIEW","CLICK","CHOOSE","COPY","DRAG","FORK","NOTE","TIP","TYPE","SCROLL"],l='<img class="as-icon-TITLE" src="'+Aero.constants.PATH+'assets/images/icons/TITLE.png" title="TITLE" />';for(var c in p)if("string"==typeof p[c]){o="OVERVIEW"==p[c]?"Overview":"";e.title=e.title.replace(p[c],l.replace(/TITLE/g,p[c].toLowerCase())+" "+o)}e.showTitle&&(o='<div class="aero-tip-title">'+e.title+'<span></span><a title="Close Guide">&#10005;</a></div>');var d=e.multi?"":"<div class='aero-tip-nav clearfix'><div class='aero-progress'><span>Step "+a+" of "+n+"</span></div></div>";Aero.tip._guide||(d=""),e.answers&&e.answers.length>0&&(r=Aero.view.quiz.render(e.answers,e.quizsize)),(e.embed||e.youtube)&&(i=Aero.view.media.render(e));var f="Enterprise"==AeroStep.license?"":'<div class="aero-lic">Powered by <a href="http://www.jumpseat.io" target="_blank">JumpSeat</a></div>';return"<div id='"+e.id+"' class='aero-tip aero-tip-"+s+t+"' style='display:none'><div class='aero-tip-arrow'></div><div class='aero-tip-body'>"+o+e.body+r+i+"</div>"+d+f+"<div class='aero-tip-draggable'></div></div>"}},spotlight:function(e,t){var o,r,i,s,a;(o=$q(t.loc)).addClass("el-spotlight"),i=o.outerWidth()+10,s=o.outerHeight()+10,a=o.offset(),r=$q('<div class="aero-remove aero-overlay"></div>'),$q("body").append(r),r=$q("<div />").addClass("aero-remove aero-light").css({width:i,height:s,top:a.top-5,left:a.left-5}),$q("body").append(r)},setGuide:function(e,t,o){var r=this;r._guide=!1,aeroStorage.getItem("aero:session",function(i){i&&!o?(r._guide=JSON.parse(i),Aero.view.step.render(r._guide),t&&t()):Aero.model.guide.byId(e,function(e){r._guide=e,Aero.view.step.render(r._guide),aeroStorage.setItem("aero:session",JSON.stringify(r._guide),function(){t&&t()},!0)})},!0)},setStep:function(e,t,o){this._current=parseInt(e),t?o&&o():aeroStorage.setItem("aero:session:current",this._current,function(){o&&o()},!0)},redirect:function(e,t,o){var r=this,i=!1,s=document.URL,a=aeroStorage.override?Aero.host:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"");if("/#/"==e&&(i=!0),e||(e=""),e=(o||a)+e,o||(e=e.replace(Aero.host,location.protocol+"//"+location.host)),i||(/#$/.test(s)&&(s=s.replace("#","")),/\/$/.test(s)&&(s=s.slice(0,-1))),e=AeroStep.getSubURL(e),"all"==t)return!1;if("par"==t&&(s=s.split("?")[0],e=e.split("?")[0]),"anc"==t&&(s=s.split("#")[0],e=e.split("#")[0]),s!=e){var n=aeroStorage.getItem("aero:session:404"),p=n?parseInt(n)+1:0;if(aeroStorage.setItem("aero:session:404",p),p>1)Aero.confirm({ok:AeroStep.lang.done,title:AeroStep.lang.notfound,msg:AeroStep.lang.urlloop+"</br></br><strong>"+e+"</strong>",onConfirm:function(){Aero.tip.stop()},onClose:function(){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward")}});else{if(Aero.forceTakeme||Aero.navigating||0==Aero.tip._current)return Aero.navigating=!1,window.location=e,!0;Aero.confirm({ok:AeroStep.lang.oopst,cancel:AeroStep.lang.oopsm,title:AeroStep.lang.oops,msg:AeroStep.lang.oopsdesc,onConfirm:function(){window.location=e},onCancel:function(){Aero.forceTakeme=!0;var e=Aero.tip._current-1;r.setStep(e,!1,function(){Aero.tip.jumpTo(e)})},onClose:function(){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward")}})}return!0}return!1},validate:function(){var e=!0,t=Aero.step.get(this._current);return t.answers&&t.answers.length>0&&(e=Aero.view.quiz.validate(t)),e},start:function(e,t,o){var r=t||0,i=this;aeroStorage.getItem("aero:session:cds",function(t){t?Aero.host=t:aeroStorage.setItem("aero:session:cds",Aero.host,function(){},!0),i._forward=!0,i.setGuide(e,function(){i.setNav(),i.beforeShow(r),Aero.audit.init(function(){i.setNav(),$q(".aero-restrict").remove(),i.beforeShow(r)})},o)},!0)},stop:function(){var e=this;e.validate()&&(Aero.audit.save(),aeroStorage.getItem("aero:session:cds",function(t){t&&(Aero.host=AeroStep.host,aeroStorage.removeItem("aero:sidebar:cdshost",!0),aeroStorage.removeItem("aero:session:cds",!0),aeroStorage.removeItem("aero:guides",null),aeroStorage.removeItem("aero:cache",null)),$q(".aero-play").remove(),aeroStorage.setItem("aero:cache",-1);e.isReturnBranch()||(Aero.view.step.record&&Aero.view.step.record.off(),Aero.tip._guide.step&&Aero.tip._current==Aero.tip._guide.step.length-1&&e.sayCongrats(),e.setStep(null),e.hide(e._current),clearInterval(e.ob),AeroStep.session.destroy(),Aero.tip._guide=null,Aero.guide.init())},!0))},next:function(){if(this.validate())if("1"!=aeroStorage.getItem("aero:session:end")){var e=Aero.step.get(this._current);this._forward=!0,clearInterval(this.ob),aeroStorage.removeItem("aero:session:pause"),-1!=e.next&&(this.hide(this._current),this.beforeShow(e.next))}else AeroStep.admin||self.stop()},prev:function(){var e=Aero.step.get(this._current);this._forward=!1,clearInterval(this.ob),aeroStorage.removeItem("aero:session:pause"),-1!=e.prev&&(this.hide(this._current),this.beforeShow(e.prev))},jumpTo:function(e){if("1"==aeroStorage.getItem("aero:session:end"))AeroStep.admin?aeroStorage.removeItem("aero:session:end"):self.stop();else{var t=Aero.step.get(e);this._forward=!0,clearInterval(this.ob),Aero.jump=!0,$q(".aero-play").remove(),aeroStorage.removeItem("aero:session:pause"),t&&(this.hide(this._current),this.beforeShow(e))}},findStep:function(e){var t=!1;return"orphan"==e.position&&(e.loc="body"),e.loc&&(0!==(t=e.isFrame?$q(e.framePath).contents().find(e.loc):$q(e.loc)).length&&t.is(":visible")&&"hidden"!=t.css("visibility")||(t=!1)),t},findStepTimeout:function(type,step,time,i){var self=this;if(!(Aero.hashChange||(clearTimeout(Aero.timeFindStep),$q(".aero-modal:visible").length>0)))if(self.tries<2*time)Aero.timeFindStep=setTimeout(function(){self.hide(i-1);var before=self._forward?step.beforeCode:self._guide.step[i].beforeCode;if(before)try{eval(before)}catch(e){Aero.log("Before show code is broken: "+e,"error")}self.show(i),self.tries++},500);else{Aero.view.step.setState(i,"missing");var prefix="loss"==type?"loss":"";if("alert"==step[type])this.renderException(step[prefix+"alert"],step[prefix+"alertContent"],!0);else if("back"==step[type])Aero.view.step.setState(i,"missing"),this.prev();else if("skip"==step[type])self.next();else if("skipto"==step[type]){self.jumpTo(step[prefix+"skipto"]);for(var i=Aero.tip._current;i<=step[prefix+"skipto"]-1;i++)Aero.view.step.setState(i,"missing")}else{if("ignore"==step[type])return;this.renderException("Step is Missing","To fix this, try:<ul style='font-size:14px'><li>Using a more generic element</li><li>Increase the step wait timer</li><li>Check the previous step navigation:<ul><li>Page changed or refreshed - when steps move between pages</li><li>Next item visible - on the same page, but has an animation or time delay when showing the next step</li></ul></li></ul>",!0)}}},observe:function(e,t,o){var r=this,i=Aero.step.get(e);t?(clearInterval(r.obf),r.obf=setInterval(function(){var e=r.findStep(i);Aero.navigating=!0,Aero.log("Observing for item visible","info"),e&&(Aero.log("Observe found item","success"),clearInterval(r.obf),o())},500)):(clearInterval(r.ob),r.ob=setInterval(function(){Aero.log("Observing for item not visible","info");r.findStep(i)||setTimeout(function(){if(Aero.navigating)return Aero.navigating=!1,void clearInterval(r.ob);Aero.log("Observe lost item","warn"),o(),clearInterval(r.ob)},500)},1e3))},beforeShow:function(i){var self=this;self.tries=1;var step=Aero.step.get(i);self.setStep(i,!1,function(){var wait=200,before=self._forward?step.beforeCode:self._guide.step[i].beforeCode;if(step.pause&&(wait=1e3*parseInt(step.pause)),before)try{eval(before)}catch(e){Aero.log("Before show code is broken: "+e,"error")}clearTimeout(Aero.timeBeforeShow),Aero.timeBeforeShow=setTimeout(function(){Aero.hashChange||self.show(i)},wait)})},show:function(i,skipStore){var $tip,$el,step,self;self=this,clearTimeout(Aero.timeFindStep),0!=Aero.tip._guide.step.length&&(void 0===i&&(i=self._current),!Aero.tip._guide||i>Aero.tip._guide.step.length||i<0||(aeroStorage.setItem("aero:session:forward",!0),step=Aero.step.get(i),aeroStorage.setItem("aero:sidebar:open",step.sidebar?0:1,function(){},!0),self.setStep(i,skipStore,function(){if(step.sidebar?setTimeout("Aero.view.sidebar.hide();",100):aeroStorage.getItem("aero:sidebar:open",function(e){$q(".aero-sidebar").hasClass("open")||"1"!=e||Aero.view.sidebar.show()},!0),$el=self.findStep(step,i),AeroStep.admin&&aeroStorage.getItem("aero:session:pause")&&aeroStorage.getItem("aero:session:forwardUrl")!==document.URL){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward");var $play=$q('<a class="aero-play aero-play-icon"><span></span></a>'),$overlay=$q('<div class="aero-play aero-play-shadow"></div>');return $play.css({top:$q(window).height()/2-150,left:$q(window).width()/2-100}),$overlay.css({opacity:.4}),$q("body").append($play,$overlay),void(Aero.view.step.record&&aeroStorage.getItem("aero:session:recording")&&Aero.view.step.record.on(!0))}if(!self.redirect(step.url,step.noUrl,step.cds)){if(aeroStorage.removeItem("aero:session:404"),$el&&$el.is(":visible")){Aero.log("Found Step "+i,"success"),Aero.navigating=!1,Aero.tip.isMoving=null,self.observe(i,!1,function(){self.findStepTimeout("loss",step,0,i)}),step.mask&&""!=step.mask&&$el.mask(step.mask),Aero.audit.update(),AeroStep.admin&&(aeroStorage.setItem("aero:sidebar:cdshost",i+"~"+window.location.host,function(){},!0),aeroStorage.setItem("aero:session:pause",i),aeroStorage.setItem("aero:session:forwardUrl",document.URL)),$tip=$q(self.options.template(step)),step.branch&&($tip=self.renderBranch($tip,step.branch,step.branchstep,step.return)),$tip=self.buildNav($tip,step),$q(".ae-active-el").removeClass("ae-active-el"),$el.addClass("ae-active-el"),$q("body").append($tip),Aero.view.step.setState(i);try{step.onCode&&eval(step.onCode)}catch(e){Aero.log("On show code error: "+e,"error")}step.spotlight&&self.spotlight($tip,step),self.setPosition($el,$tip,step.position),self.setEvents($el,step.nav,$tip,step.position),"orphan"!=step.position?self.scrollToElement($el):$q(".aero-tip").fadeIn(200)}else{if(step.tries&&step.tries>0)return void self.findStepTimeout("miss",step,step.tries,i);step.multi||(clearTimeout(Aero.timeFindStep),Aero.log("Skipping step: "+i+" with loc:"+step.loc,"error"),Aero.view.step.setState(i,"missing"),i<Aero.tip._guide.step.length&&(self._forward?self.next():self.prev()))}var d=self._forward?1:-1,isMulti=!1;(self._forward&&Aero.step.get(i+d).multi||!self._forward&&step.multi)&&(isMulti=!0),Aero.jump&&step.multi&&(isMulti=!0,d=-1,self._forward=!1),isMulti&&self.show(i+d,!0),Aero.jump=null}})))},hide:function(i){var step=Aero.step.get(i);if(!(!$q(".aero-tip:visible").length>0)){if(step.offCode)try{eval(step.offCode)}catch(e){Aero.log("Before hide code is broken: "+e,"error")}if($q(".aero-active, .aero-showElement").removeClass("aero-active aero-showElement aero-relativePosition"),$q(".aero-tip, .aero-remove").remove(),step.afterCode)try{eval(step.afterCode)}catch(e){Aero.log("After hide code is broken: "+e,"error")}}},buildNav:function(e,t){var o="",r=!1;return t.nav.next||t.nav.blur||(r=!0),0==t.nav.length&&(r=!1),t.noNav||(-1==t.next&&(o+="<a class='aero-btn-end'>"+this.options.labels.end+"</a>"),t.noNext||r||-1==t.next||(o+="<a class='aero-btn-next'>"+this.options.labels.next+"</a>"),t.noPrev||-1==t.prev||(o+="<a class='aero-btn-prev'>"+this.options.labels.prev+"</a>")),e.find(".aero-tip-nav").append(o),e},setPosition:function(e,t,o){var r={},i=e.offset(),s=t.outerWidth()/2,a=t.outerHeight(),n=i.left+e.outerWidth()/2,p=i.top+e.outerHeight()/2,l=t.find(".aero-tip-arrow");switch(r.tLeft=s-l.outerWidth()/2,r.tTop=t.outerHeight()/2-l.outerHeight()/2,o){case"top":r.left=n-s,r.top=i.top-a-t.find(".aero-tip-arrow").outerHeight();break;case"bottom":r.left=n-s,r.top=i.top+e.outerHeight();break;case"left":r.left=i.left-t.outerWidth()-t.find(".aero-tip-arrow").outerWidth(),r.top=p-a/2;break;case"right":r.left=i.left+e.outerWidth(),r.top=p-a/2;break;case"orphan":r.left=$q(window).width()/2-s,r.top=$q(window).height()/2-a/2}r=this.containIn(document,t,r,o),t.css({left:r.left,top:r.top}),(t.hasClass("aero-tip-bottom")||t.hasClass("aero-tip-top"))&&l.css({left:r.tLeft}),(t.hasClass("aero-tip-left")||t.hasClass("aero-tip-right"))&&l.css({top:r.tTop}),t.hasClass("aero-tip-top")&&l.css({top:"auto"})},containIn:function(e,t,o,r){var i=$q(e).height(),s=$q(window).width(),a=o.left+t.outerWidth()-s,n=o.top+t.outerHeight()-i;a>0&&("bottom"!=r&&"top"!=r||(o.tLeft+=a),o.left-=a),o.left<0&&("bottom"!=r&&"top"!=r||(o.tLeft+=o.left),o.left-=o.left),o.top<0&&("left"!=r&&"right"!=r||(o.tTop+=o.top),o.top-=o.top),n>0&&"bottom"==r&&("left"!=r&&"right"!=r||(o.tTop+=n),o.top-=n);return o.left+t.outerWidth()>s-270?aeroStorage.getItem("aero:sidebar:open",function(e){Aero.view.sidebar.hide()},!0):aeroStorage.getItem("aero:sidebar:open",function(e){"1"==e&&Aero.view.sidebar.show()},!0),o},scrollToElement:function(e){var t,o,r,i,s;(t=$q(".aero-tip:eq(0)")).show(),o=Aero.pos.isScrollable(e),e.visible(!1,o)&&t.visible(!1)?(t.hide(),$q(".aero-tip").fadeIn(200)):(i=o?o.height()/2:$q(window).height()/2,r=o?o.scrollTop()-o.offset().top:0,o=o||$q("body, html"),s=r+t.offset().top-i+t.outerHeight()/2,t.hide(),o.stop().animate({scrollTop:s},500,function(){$q(".aero-tip").fadeIn(200)}))},isReturnBranch:function(){var e=aeroStorage.getItem("aero:session:branch:returnid"),t=aeroStorage.getItem("aero:session:branch:returnto");return!!e&&(t&&""!=t||(t=0),Aero.confirm({ok:"Return",cancel:"End Guide",title:"Branch complete",msg:"You have completed this branch, we will now move you back to the original guide.",onConfirm:function(){Aero.audit.save(),Aero.tip.hide(),Aero.tip.start(e,parseInt(t),!0),aeroStorage.removeItem("aero:session:branch:returnid"),aeroStorage.removeItem("aero:session:branch:returnto")},onCancel:function(){aeroStorage.removeItem("aero:session:branch:returnid"),Aero.tip.stop()}}),!0)},renderBranch:function(e,t,o,r){var s=e.find(".aero-tip-body").html()+"<div class='aero-branch'></div>";return setTimeout(function(){for(i in t)"string"==typeof t[i]&&Aero.guide.get(t[i],function(e){0==$q(".aero-branch").find("#b-"+e.id).length&&$q(".aero-branch").append("<a id='b-"+e.id+"' data-returnid='"+Aero.tip._guide.id+"' data-returnto='"+r+"' data-guideid='"+e.id+"' class='aero-start'>"+e.title+"</a>"),$q(window).trigger("resize")})},250),e.find(".aero-tip-body").html(s),e},renderException:function(e,t,o){var r="";if(o&&AeroStep.admin){r='<div class="aero-section aero-goto"><label>Go back to step:</label><select id="aero-goto">';for(var i=0;i<Aero.tip._guide.step.length;i++){r+="<option "+(i==Aero.tip._current-1?'selected="selected"':"")+'value="'+i+'">'+(i+1)+": "+Aero.tip._guide.step[i].title+"</option>"}r+="</select></div>"}Aero.confirm({ok:"End Guide",cancel:o?"Go Back":"Ok",title:e,msg:t+r,onConfirm:function(){Aero.tip.stop()},onCancel:function(){o&&AeroStep.admin?Aero.tip.jumpTo(parseInt($q("#aero-goto").val())):o&&Aero.tip.prev()},onClose:function(){Aero.view.step.setState(aeroStorage.getItem("aero:session:pause"),"forward")}})},setNav:function(){var e=this;$q("body").off("mousedown.aPe").on("mousedown.aPe",".aero-btn-prev",function(){return Aero.navigating=!0,e.prev(),!1}).off("click.aEd").on("click.aEd",".aero-btn-end",function(){e.stop()})},sayCongrats:function(){aeroStorage.getItem("aero:session",function(e){var t=JSON.parse(e);AeroStep.admin||Aero.confirm({ok:AeroStep.lang.ok,cancel:"",title:AeroStep.lang.gfinished,msg:AeroStep.lang.congrats+t.title,onConfirm:function(){AeroStep.session.destroy()}})},!0)},setEvents:function(e,t,o,r){var i=this;$q(document).off("scroll.scw").on("scroll.scw"+Aero.tip._current,function(){i.setPosition(e,o,r)},250),$q('div *:not(".aero-steps")').off("scroll.scd").on("scroll.scd"+Aero.tip._current,function(){i.setPosition(e,o,r)},250),$q(".aero-tip").draggable({handle:"div.aero-tip-draggable"}),$q("body").off("click.ctxx").on("click.ctxx",".aero-tip-title a",function(){Aero.tip.stop()}),$q(window).on("resize",function(){i.setPosition(e,o,r),Aero.view.sidebar.setScrollable()},250),aeroStorage.removeItem("aero:session:end"),parseInt($q(".aero-tip:last").attr("id").replace("astep-",""))==Aero.tip._guide.step.length-1&&aeroStorage.setItem("aero:session:end",1),$q("body").off("click.branchc").on("click.branchc",".aero-continue",function(){Aero.tip.next()}),$q("body").off("click.branchs").on("click.branchs",".aero-start",function(){aeroStorage.setItem("aero:session:branch:returnid",$q(this).data("returnid")),aeroStorage.setItem("aero:session:branch:returnto",$q(this).data("returnto")),aeroStorage.setItem("aero:session:branch:audit",1),Aero.tip.hide(),Aero.tip.start($q(this).data("guideid"),0,!0)}),$q("body").off("mousedown.aNe").on("mousedown.aNe",".aero-btn-next",function(){return Aero.navigating=!0,i.next(),!1});for(var s in t)if(t.hasOwnProperty(s))switch(-1==t[s]&&(t[s]=Aero.tip._current+1),t[s]=parseInt(t[s]),s){case"next":$q("body").off("mousedown.aNe").on("mousedown.aNe",".aero-btn-next",function(){if(Aero.navigating=!0,i.validate())return i.jumpTo(t[s]),!1});break;case"click":e.off("click.aeronav").on("click.aeronav",e,function(){e.off("click.aeronav"),Aero.navigating=!0,i.validate()&&i.jumpTo(t[s])});break;case"rclick":e.off("contextmenu.aeronav").on("contextmenu.aeronav",e,function(){e.off("contextmenu.aeronav"),Aero.navigating=!0,i.validate()&&i.jumpTo(t[s])});break;case"mousedown":e.off("mousedown.aeronav").on("mousedown.aeronav",e,function(){Aero.navigating=!0,i.validate()&&i.jumpTo(t[s])});break;case"hover":e.off("mouseenter.aeronav").on("mouseenter.aeronav",e,function(){Aero.navigating=!0,i.validate()&&setTimeout(function(){i.jumpTo(t[s])},500)});break;case"blur":e.off("keydown.aeronav").on("keydown.aeronav",e,function(e){if(Aero.navigating=!0,i.validate()){var o=e.keyCode||e.which;13!=o&&9!=o||i.jumpTo(t[s])}}),e.off("focusout.aeronavb").on("focusout.aeronavb",e,function(e){Aero.navigating=!0,i.validate()&&i.jumpTo(t[s])});break;case"unload":$q(window).off("beforeunload.aeronav").on("beforeunload.aeronav",function(){Aero.navigating=!0,i.setStep(t[s])});break;case"observe":i.observe(i._current+1,!0,function(){Aero.navigating=!0,i.next()})}}};
"use strict";Aero.model.guide={url:"api/guides",urlSearch:"api/search",defaults:function(){return{title:"",active:!1,steps:[]}},byId:function(e,t){Aero.guide.getAll(function(o){$q.each(o,function(a,r){r&&e==r.id&&(t(o[a]),aeroStorage.setItem("aero:session:index",a,function(){},!0))})})},update:function(e,t){Aero.guide.getAll(function(o){Aero.view.guide.render(o),e&&e(t)},!0)},validate:function(){var e=$q("form").isFormValid();return""==$q("#aeroEditor").trumbowyg("html").replace(/<br>/g,"")&&(e=!1,$q(".trumbowyg-editor").addClass("aero-require-error")),e||$q("#aeroSection0 p:first").after('<div class="aero-error-box">'+AeroStep.lang.requirede+"</div>"),e}},Aero.view.guide={render:function(e,t,o){var a=this;$q(".aero-restrict, .aero-contextual").remove(),o||a.clearSearch(),Aero.tpl.get("sidebar-guides.html",function(t){aeroStorage.getItem("aero:sidebar:open",function(o){aeroStorage.getItem("aero:session:tab",function(r){$q("#aeroGuidebar").remove();var i=_q.template(t);$q("body").append(i({sidebar:o,guides:e})),$q("#aeroStepbar").remove(),r>$q("#aeroGuidebar").outerHeight()&&(r=$q("#aeroGuidebar").outerHeight()-100),r<0&&(r=0),$q("#aero-tab").css("top",r+"px"),a.setEvents(),Aero.view.sidebar.setEvents(),Aero.view.sidebar.setScrollable();var n=parseInt($q("body").data("newguides"));n>0&&Aero.view.sidebar.notify(n)},!0)},!0)})},renderContextualTip:function(e,t){Aero.guide.get(e,function(o){!function(t,o){var a=$q(Aero.tip.options.template(t)),r=e+"-"+o;a.attr("id","atip-"+r),a.addClass("aero-action-tip"),$q("body").append(a),Aero.tip.setPosition($q("#aaction-"+r),$q("#atip-"+r),t.position),a.show()}(o.step[t],t)})},renderContextualAction:function(e){if(e.contextual&&0!=e.contextual.length)for(var t in e.contextual)if(e.step.length>0){var o=parseInt(e.contextual[t]);e.step[o]&&e.step[o].loc&&a(o,e.step[o].loc)}function a(t,o){var a,r;if((a=$q(o)).length>0){var i=a.offset();r=$q("<a />").attr("id","aaction-"+e.id+"-"+t).addClass("aero-contextual").css({top:i.top+a.outerHeight()/2-8,left:i.left+a.outerWidth()}).data("loc",o).data("guideid",e.id).data("step",parseInt(t)),$q("body").append(r)}}},renderRestrict:function(e){var t=this;if(!e.isComplete&&e.restrict&&0!=e.restrict.length)for(var o in e.restrict)o=parseInt(o.replace("s","")),e.step.length>0&&a(o,e.step[o].loc,e.step[o].restrictColor);function a(o,a,r){var i;$q(a).length>0&&(i=$q("<a />").addClass("aero-restrict").css({"background-color":r,cursor:"pointer",opacity:.5}).data("loc",a).data("guideid",e.id).data("step",parseInt(o)),$q("body").append(i),t.positionRestrict(i))}},positionRestrict:function(e){var t=$q(e.data("loc")),o=Aero.pos.isFixed(t)?"fixed":"absolute";e.css({width:t.outerWidth(),height:t.outerHeight(),top:t.offset().top,left:t.offset().left,position:o,"z-index":99999999})},search:function(e){var t=this;$q(".aero-search i").switchClass("fa-search","fa-times",0),$q(".aero-search a").switchClass("aero-search-btn","aero-search-clear",0),Aero.guide.getByTerm(e,function(o){o.search=e,t.render(o,function(){},!0)})},clearSearch:function(){$q(".aero-search-clear").length>0&&($q(".aero-search i").switchClass("fa-times","fa-search",0),$q(".aero-search a").switchClass("aero-search-clear","aero-search-btn",0),$q(".aero-search").removeClass("aero-active"),$q("input[name=aero_search]").val(AeroStep.lang.search))},setEvents:function(){var e=this;$q("body").off("click.aeroStart").on("click.aeroStart",".aero-guides ul li > a",function(){var e=$q(this).parents("li:eq(0)").data("guideid");aeroStorage.removeItem("aero:session:pause"),Aero.tip.start(e)}),$q("body").off("click.apF").on("focus.apF",".aero-sidebar input[name=aero_search]",function(){$q(this).parents("div:eq(0)").addClass("aero-active"),$q(this).val()==AeroStep.lang.search&&$q(this).val("")}),$q("body").off("click.apB").on("blur.apB",".aero-sidebar input[name=aero_search]",function(){""==$q(this).val()&&($q(this).parents("div:eq(0)").removeClass("aero-active"),$q(this).val(AeroStep.lang.search))}),$q("body").off("click.aS").on("click.aS",".aero-search a.aero-search-btn",function(){e.search($q("input[name=aero_search]").val())}),$q("body").off("keypress.asK").on("keypress.asK",".aero-sidebar input[name=aero_search]",function(t){13==(t.keyCode||t.which)&&e.search($q(this).val())}),$q("body").off("click.asC").on("click.asC",".aero-search-clear",function(){return Aero.guide.getAll(function(t){e.render(t)}),!1}),$q("body").off("click.asr").on("click.asr",".aero-restrict",function(){var e=$q(this);Aero.confirm({ok:AeroStep.lang.ok,title:AeroStep.lang.restrictt,msg:AeroStep.lang.restrictb,onConfirm:function(){Aero.tip.start(e.data("guideid"))}})}),$q("body").off("mouseenter.actip").on("mouseenter.actip",".aero-contextual",function(){var t=$q(this),o=t.data("guideid"),a=t.data("step");$q(".aero-action-tip").remove(),setTimeout(function(){e.renderContextualTip(o,a)},250)}),$q("body").off("mouseleave.actip").on("mouseleave.actip",".aero-contextual",function(){$q(".aero-action-tip").remove()}),$q("body").on("click",'input[name="aero_auto"]',function(){$q(".aero-auto-page").hide(),$q(this).is(":checked")&&$q(".aero-auto-page").show()})}},Aero.guide={init:function(){var e=this;Aero.tpl.get("sidebar-guides.html",function(){aeroStorage.getItem("aero:session:end")&&Aero.tip.sayCongrats(),e.getAll(function(e){aeroStorage.getItem("aero:session",function(t){var o=Aero.utils.getUrlParam("guideid");if(t){var a=JSON.parse(t);aeroStorage.getItem("aero:session:current",function(e){Aero.tip.start(a.id,parseInt(e))},!0)}else if(o)Aero.tip.start(Aero.utils.getUrlParam("guideid")),window.history.pushState("object or string","Title",window.location.href.replace("guideid","startedid"));else{var r=aeroStorage.getItem("aero:pathway");r&&"0"!=r?Aero.pathway.get(function(t){Aero.view.pathway.render(t,parseInt(r))||Aero.view.guide.render(e)}):Aero.view.guide.render(e)}},!0)})})},autoStart:function(e){if(Aero.view.guide.renderRestrict(e),Aero.view.guide.renderContextualAction(e),e.auto&&!e.isStarted&&!AeroStep.admin&&e.step.length>0){var t=!1;e.autoPage?t=!0:e.step.length>0&&window.location.pathname==e.step[0].url&&(t=!0),t&&(aeroStorage.setItem("aero:guide:auto",1),Aero.tip.start(e.id))}},updateCache:function(e){aeroStorage.setItem("aero:guides",JSON.stringify(e))},getAll:function(e,t){aeroStorage.getItem("aero:guide:auto")&&(t=!0,aeroStorage.removeItem("aero:guide:auto"));var o=null,a=aeroStorage.getItem("aero:guides"),r=aeroStorage.getItem("aero:cache"),i=aeroStorage.getItem("aero:locale");r||(r=AeroStep.cache),i||(r=AeroStep.locale),(r=parseInt(r))==AeroStep.cache&&i==AeroStep.locale||(o=JSON.parse(a),aeroStorage.removeItem("aero:guides"),a=null),!a||t?(Aero.log("Loading from SS","success"),Aero.send(Aero.model.guide.url,{enduser:Aero.constants.USERNAME},function(t){if(o){var a=t.length-o.length;a>0&&$q("body").data("newguides",a)}aeroStorage.setItem("aero:cache",AeroStep.cache),aeroStorage.setItem("aero:locale",AeroStep.locale),aeroStorage.setItem("aero:guides",JSON.stringify(t)),e&&e(t)})):(Aero.log("Loading from LS","success"),e(JSON.parse(a)))},get:function(e,t){Aero.send(Aero.model.guide.url,{id:e},function(e){t&&t(e)})},getByTerm:function(e,t){Aero.send(Aero.model.guide.urlSearch,{term:e},function(e){t&&t(e)})},create:function(e,t){Aero.send(Aero.model.guide.url,e,function(e){Aero.model.guide.update(t,e)},"POST")},update:function(e,t){Aero.send(Aero.model.guide.url,e,function(){Aero.model.guide.update(),t&&t()},"PUT")},destroy:function(e){Aero.send(Aero.model.guide.url,{id:e},function(){Aero.model.guide.update()},"DELETE")}},Aero.view.sidebar={setScrollable:function(){var e=$q(window).height()-($q(".aero-head").outerHeight()+$q(".aero-foot").outerHeight()),t=$q(".aero-guide-title").outerHeight(),o=$q(".aero-add-step").length>0?$q(".aero-add-step").outerHeight():0;$q(".aero-guides, .aero-steps").height(e-(t+o))},show:function(e,t){$q(".aero-sidebar").stop().animate({right:"-50px"},t,"easeInOutBack",function(){}).addClass("open"),e&&aeroStorage.setItem("aero:sidebar:open",1,function(){},!0)},hide:function(e){$q(".aero-sidebar").stop().animate({right:-$q(".aero-sidebar").outerWidth(!0)},300,"swing",function(){}).removeClass("open"),$q(".aero-admin-wrapper").length&&($q(".aero-admin-wrapper").remove(),$q("#aero-tab").css("left","-44px")),$q(".aero-blanket, .aero-edit-active").remove(),e&&aeroStorage.setItem("aero:sidebar:open",0,function(){},!0)},notify:function(){$q("#aero-tab").prepend('<span class="aero-not">'+$q("body").data("newguides")+"</span>")},setEvents:function(){var e,t=this;window.onresize=function(){clearTimeout(e),e=setTimeout(function(){t.setScrollable();var e=$q(".aero-restrict");0!=e.length&&e.each(function(){Aero.view.guide.positionRestrict($q(this))})},100)},$q("body").off("click.atc").on("click.atc","#aero-tab a",function(){$q(".aero-sidebar").hasClass("open")?t.hide(!0):t.show(!0)}),$q("#aero-tab").draggable({axis:"y",distance:10,containment:"body",stop:function(e,t){aeroStorage.setItem("aero:session:tab",t.offset.top,function(){},!0)}}),$q(window).off("hashchange.hashn").on("hashchange.hashn",function(){Aero.hashChange=!0,AeroStep.ready(function(){setTimeout(function(){Aero.hashChange=!1,Aero.guide.init()},500)},AeroStep.required)})}};
"use strict";function AeroMain(){$q(function(){aeroStorage.getItem("aero:sidebar:cdshost",function(e){if(e){var o=e.split("~");o[1]!=window.location.host&&aeroStorage.setItem("aero:session:pause",o[0])}Aero.guide.init()},!0)}),Aero.pathway.init()}AeroMain();